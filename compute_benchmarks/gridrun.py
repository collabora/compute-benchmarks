# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/01_gridrun.ipynb.

# %% auto 0
__all__ = ['grid_run', 'grid_show']

# %% ../nbs/01_gridrun.ipynb 3
import numpy as np
import pylab as plt
from functools import partial

# %% ../nbs/01_gridrun.ipynb 4
def grid_run(fun, **kwargs):
    (k1, v1s), (k2, v2s) = kwargs.items()
    results = np.zeros((len(v1s), len(v2s)))
    for i in range(5):
        fun(**{k1:v1s[0], k2:v2s[0]})
    for i1, v1 in enumerate(v1s):
        for i2, v2 in enumerate(v2s):
            results[i1, i2] = fun(**{k1:v1, k2:v2})
    return dict(
        k1=k1, v1s=v1s,
        k2=k2, v2s=v2s,
        results=results,
    )

# %% ../nbs/01_gridrun.ipynb 5
def grid_show(r, figsize=(6,6), colorfun=np.log, textfun=lambda x: x):
    plt.figure(figsize=figsize)
    plt.imshow(colorfun(r['results']), cmap='Blues')
    ax = plt.gca()
    v1s, v2s = r['v1s'], r['v2s']
    yticks, xticks = range(len(v1s)), range(len(v2s))
    ax.set_xlabel(r['k2'])
    ax.set_xticks(xticks)
    ax.set_xticklabels(v2s)
    ax.set_ylabel(r['k1'])
    ax.set_yticks(yticks)
    ax.set_yticklabels(v1s)
    for y in yticks:
        for x in xticks:
            plt.text(x, y, f"{textfun(r['results'][y,x]):.2f}", ha="center", va="bottom")
